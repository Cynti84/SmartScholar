<app-dashboard-layout [title]="'Manage Scholarships'" [menu]="menu" logoUrl="logo.png">
  <section class="manage-scholarships-container">
    
    <!-- Header Section -->
    <div class="header-section">
      <div class="header-content">
        <h1>My Scholarships</h1>
        <p>Manage and track all your posted scholarships</p>
      </div>
      <button class="btn btn-primary" (click)="navigateToPost()">
        <span class="icon">➕</span>
        Post New Scholarship
      </button>
    </div>

    <!-- Summary Cards -->
    <div class="summary-cards">
      <div class="summary-card total">
        <div class="card-content">
          <div class="card-icon">📚</div>
          <div class="card-data">
            <span class="card-value">{{ getTotalScholarships() }}</span>
            <span class="card-label">Total Scholarships</span>
          </div>
        </div>
      </div>
      
      <div class="summary-card pending">
        <div class="card-content">
          <div class="card-icon">⏳</div>
          <div class="card-data">
            <span class="card-value">{{ getScholarshipsByStatus('Pending').length }}</span>
            <span class="card-label">Pending Review</span>
          </div>
        </div>
      </div>
      
      <div class="summary-card approved">
        <div class="card-content">
          <div class="card-icon">✅</div>
          <div class="card-data">
            <span class="card-value">{{ getScholarshipsByStatus('Approved').length }}</span>
            <span class="card-label">Approved</span>
          </div>
        </div>
      </div>
      
      <div class="summary-card applications">
        <div class="card-content">
          <div class="card-icon">👥</div>
          <div class="card-data">
            <span class="card-value">{{ getTotalApplications() }}</span>
            <span class="card-label">Total Applications</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Filters & Search -->
    <div class="filters-section">
      <div class="search-container">
        <div class="search-input-wrapper">
          <span class="search-icon">🔍</span>
          <input 
            type="text" 
            placeholder="Search scholarships..." 
            [(ngModel)]="searchTerm"
            (input)="applyFilters()"
            class="search-input">
        </div>
      </div>
      
      <div class="filter-controls">
        <select [(ngModel)]="statusFilter" (change)="applyFilters()" class="filter-select">
          <option value="">All Status</option>
          <option value="Pending">Pending</option>
          <option value="Approved">Approved</option>
          <option value="Rejected">Rejected</option>
          <option value="Expired">Expired</option>
        </select>
        
        <select [(ngModel)]="sortBy" (change)="applyFilters()" class="filter-select">
          <option value="dateCreated">Sort by Date Created</option>
          <option value="title">Sort by Title</option>
          <option value="applications">Sort by Applications</option>
          <option value="views">Sort by Views</option>
        </select>
        
        <button class="filter-btn" [class.active]="showExpiredOnly" (click)="toggleExpiredOnly()">
          <span class="icon">⏰</span>
          {{ showExpiredOnly ? 'Show All' : 'Expired Only' }}
        </button>
      </div>
    </div>

    <!-- Scholarships Table -->
    <div class="table-container">
      <div class="table-header">
        <h3>{{ filteredScholarships.length }} Scholarship{{ filteredScholarships.length !== 1 ? 's' : '' }}</h3>
        <div class="view-controls">
          <button 
            class="view-btn" 
            [class.active]="viewMode === 'table'"
            (click)="setViewMode('table')">
            <span class="icon">📋</span>
            Table
          </button>
          <button 
            class="view-btn" 
            [class.active]="viewMode === 'cards'"
            (click)="setViewMode('cards')">
            <span class="icon">📱</span>
            Cards
          </button>
        </div>
      </div>

      <!-- Table View -->
      <div class="table-wrapper" *ngIf="viewMode === 'table'">
        <table class="scholarships-table">
          <thead>
            <tr>
              <th>Scholarship Details</th>
              <th>Status</th>
              <th>Deadline</th>
              <th>Analytics</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let scholarship of filteredScholarships; trackBy: trackByScholarshipId">
              <td class="scholarship-details">
                <div class="scholarship-info">
                  <h4 class="scholarship-title">{{ scholarship.title }}</h4>
                  <p class="scholarship-summary">{{ scholarship.shortSummary }}</p>
                  <div class="scholarship-meta">
                    <span class="meta-item">
                      <span class="icon">🌍</span>
                      {{ scholarship.country }}
                    </span>
                    <span class="meta-item">
                      <span class="icon">🎓</span>
                      {{ scholarship.educationLevel }}
                    </span>
                    <span class="meta-item">
                      <span class="icon">📅</span>
                      Created {{ scholarship.dateCreated | date:'MMM dd, yyyy' }}
                    </span>
                  </div>
                </div>
              </td>
              
              <td class="status-cell">
                <span 
                  class="status-badge"
                  [class]="getStatusClass(scholarship.status)">
                  {{ scholarship.status }}
                </span>
              </td>
              
              <td class="deadline-cell">
                <div class="deadline-info">
                  <span class="deadline-date">{{ scholarship.applicationDeadline | date:'MMM dd, yyyy' }}</span>
                  <span 
                    class="deadline-status"
                    [class.expired]="isExpired(scholarship.applicationDeadline)"
                    [class.soon]="isDeadlineSoon(scholarship.applicationDeadline)">
                    {{ getDeadlineText(scholarship.applicationDeadline) }}
                  </span>
                </div>
              </td>
              
              <td class="analytics-cell">
                <div class="analytics-grid">
                  <div class="analytics-item">
                    <span class="analytics-icon">👁️</span>
                    <span class="analytics-value">{{ scholarship.analytics.views }}</span>
                    <span class="analytics-label">Views</span>
                  </div>
                  <div class="analytics-item">
                    <span class="analytics-icon">🔖</span>
                    <span class="analytics-value">{{ scholarship.analytics.bookmarks }}</span>
                    <span class="analytics-label">Saved</span>
                  </div>
                  <div class="analytics-item">
                    <span class="analytics-icon">📝</span>
                    <span class="analytics-value">{{ scholarship.analytics.applications }}</span>
                    <span class="analytics-label">Applied</span>
                  </div>
                </div>
              </td>
              
              <td class="actions-cell">
                <div class="action-buttons">
                  <button 
                    class="action-btn view" 
                    (click)="viewScholarship(scholarship)"
                    title="View Details">
                    📄
                  </button>
                  <button 
                    class="action-btn edit" 
                    (click)="editScholarship(scholarship)"
                    title="Edit Scholarship"
                    [disabled]="scholarship.status === 'Rejected'">
                    ✏️
                  </button>
                  <button 
                    class="action-btn delete" 
                    (click)="deleteScholarship(scholarship)"
                    title="Delete Scholarship">
                    ❌
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
        
        <!-- Empty State -->
        <div class="empty-state" *ngIf="filteredScholarships.length === 0">
          <div class="empty-icon">📚</div>
          <h3>No scholarships found</h3>
          <p *ngIf="searchTerm || statusFilter">Try adjusting your filters or search terms</p>
          <p *ngIf="!searchTerm && !statusFilter">You haven't posted any scholarships yet</p>
          <button class="btn btn-primary" (click)="navigateToPost()" *ngIf="!searchTerm && !statusFilter">
            Post Your First Scholarship
          </button>
        </div>
      </div>

      <!-- Card View -->
      <div class="cards-container" *ngIf="viewMode === 'cards'">
        <div class="scholarship-card" *ngFor="let scholarship of filteredScholarships; trackBy: trackByScholarshipId">
          <div class="card-header">
            <div class="card-title-section">
              <h4 class="card-title">{{ scholarship.title }}</h4>
              <span 
                class="status-badge small"
                [class]="getStatusClass(scholarship.status)">
                {{ scholarship.status }}
              </span>
            </div>
            <div class="card-actions">
              <button class="action-btn view" (click)="viewScholarship(scholarship)" title="View">📄</button>
              <button class="action-btn edit" (click)="editScholarship(scholarship)" title="Edit" [disabled]="scholarship.status === 'Rejected'">✏️</button>
              <button class="action-btn delete" (click)="deleteScholarship(scholarship)" title="Delete">❌</button>
            </div>
          </div>
          
          <div class="card-content">
            <p class="card-summary">{{ scholarship.shortSummary }}</p>
            
            <div class="card-meta">
              <span class="meta-item">🌍 {{ scholarship.country }}</span>
              <span class="meta-item">🎓 {{ scholarship.educationLevel }}</span>
            </div>
            
            <div class="card-deadline">
              <span class="deadline-label">Deadline:</span>
              <span class="deadline-date">{{ scholarship.applicationDeadline | date:'MMM dd, yyyy' }}</span>
              <span 
                class="deadline-status"
                [class.expired]="isExpired(scholarship.applicationDeadline)"
                [class.soon]="isDeadlineSoon(scholarship.applicationDeadline)">
                ({{ getDeadlineText(scholarship.applicationDeadline) }})
              </span>
            </div>
          </div>
          
          <div class="card-footer">
            <div class="card-analytics">
              <div class="analytics-item">
                <span class="analytics-icon">👁️</span>
                <span class="analytics-value">{{ scholarship.analytics.views }}</span>
              </div>
              <div class="analytics-item">
                <span class="analytics-icon">🔖</span>
                <span class="analytics-value">{{ scholarship.analytics.bookmarks }}</span>
              </div>
              <div class="analytics-item">
                <span class="analytics-icon">📝</span>
                <span class="analytics-value">{{ scholarship.analytics.applications }}</span>
              </div>
            </div>
            <span class="created-date">{{ scholarship.dateCreated | date:'MMM dd' }}</span>
          </div>
        </div>
        
        <!-- Empty State for Cards -->
        <div class="empty-state" *ngIf="filteredScholarships.length === 0">
          <div class="empty-icon">📚</div>
          <h3>No scholarships found</h3>
          <p *ngIf="searchTerm || statusFilter">Try adjusting your filters or search terms</p>
          <p *ngIf="!searchTerm && !statusFilter">You haven't posted any scholarships yet</p>
          <button class="btn btn-primary" (click)="navigateToPost()" *ngIf="!searchTerm && !statusFilter">
            Post Your First Scholarship
          </button>
        </div>
      </div>
    </div>

    <!-- Bulk Actions (when items are selected) -->
    <div class="bulk-actions" *ngIf="selectedScholarships.length > 0">
      <div class="bulk-info">
        <span>{{ selectedScholarships.length }} scholarship{{ selectedScholarships.length !== 1 ? 's' : '' }} selected</span>
      </div>
      <div class="bulk-buttons">
        <button class="btn btn-outline" (click)="clearSelection()">Clear Selection</button>
        <button class="btn btn-danger" (click)="bulkDelete()">Delete Selected</button>
      </div>
    </div>
  </section>
</app-dashboard-layout>